<Page x:Class="VeterinaryManagementSystem.Views.Proveedores.SupplierView"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:local="clr-namespace:VeterinaryManagementSystem.Converters"
      Title="Gestión de Proveedores"
      Background="White">
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Título -->
        <TextBlock Text="Gestión de Proveedores"
                   FontSize="24"
                   FontWeight="SemiBold"
                   Margin="0,0,0,20"
                   Foreground="#333333"/>

        <!-- Barra de Herramientas -->
        <Grid Grid.Row="1" Margin="0,0,0,20">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- Búsqueda -->
            <Border Background="White"
                    BorderBrush="#DEDEDE"
                    BorderThickness="1"
                    CornerRadius="4"
                    Width="300"
                    HorizontalAlignment="Left">
                <Grid>
                    <TextBox Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                             BorderThickness="0"
                             Padding="8"
                             Height="35"
                             VerticalContentAlignment="Center">
                        <TextBox.Style>
                            <Style TargetType="TextBox">
                                <Style.Triggers>
                                    <Trigger Property="Text" Value="">
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="TextBox">
                                                    <Border Background="{TemplateBinding Background}"
                                                            BorderBrush="{TemplateBinding BorderBrush}"
                                                            BorderThickness="{TemplateBinding BorderThickness}">
                                                        <Grid>
                                                            <ScrollViewer x:Name="PART_ContentHost"/>
                                                            <TextBlock Text="Buscar proveedor..."
                                                                       Foreground="Gray"
                                                                       Margin="8,0,0,0"
                                                                       VerticalAlignment="Center"
                                                                       IsHitTestVisible="False"/>
                                                        </Grid>
                                                    </Border>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </TextBox.Style>
                    </TextBox>
                    <Button Command="{Binding SearchCommand}"
                            HorizontalAlignment="Right"
                            Margin="0,0,5,0">
                        <Path Data="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
                              Fill="#666666"
                              Stretch="Uniform"
                              Width="16"
                              Height="16"/>
                    </Button>
                </Grid>
            </Border>

            <!-- Botones CRUD -->
            <StackPanel Grid.Column="1" 
                        Orientation="Horizontal" 
                        HorizontalAlignment="Right">
                <Button Content="Agregar Proveedor"
                        Command="{Binding AddSupplierCommand}"
                        Style="{StaticResource PrimaryButton}"
                        Height="35"
                        Margin="0,0,10,0"/>
                <Button Content="Editar"
                        Command="{Binding UpdateSupplierCommand}"
                        Style="{StaticResource SecondaryButton}"
                        Height="35"
                        Margin="0,0,10,0"
                        IsEnabled="{Binding CanEditOrDelete}"/>
                <Button Content="Eliminar"
                        Command="{Binding DeleteSupplierCommand}"
                        Style="{StaticResource DangerButton}"
                        Height="35"
                        IsEnabled="{Binding CanEditOrDelete}"/>
            </StackPanel>
        </Grid>

        <!-- DataGrid -->
        <DataGrid Grid.Row="2"
                  ItemsSource="{Binding Suppliers}"
                  SelectedItem="{Binding SelectedSupplier}"
                  AutoGenerateColumns="False"
                  IsReadOnly="True"
                  BorderThickness="1"
                  BorderBrush="#DEDEDE"
                  RowHeight="35"
                  HeadersVisibility="Column"
                  GridLinesVisibility="Horizontal"
                  Background="White"
                  RowBackground="White"
                  AlternatingRowBackground="#F8F8F8">
            <DataGrid.Resources>
                <Style TargetType="DataGridColumnHeader">
                    <Setter Property="Background" Value="#F5F5F5"/>
                    <Setter Property="Padding" Value="8"/>
                    <Setter Property="FontWeight" Value="SemiBold"/>
                </Style>
            </DataGrid.Resources>
            <DataGrid.Columns>
                <DataGridTextColumn Header="ID" 
                                  Binding="{Binding Id}" 
                                  Width="Auto"/>
                <DataGridTextColumn Header="Empresa" 
                                  Binding="{Binding CompanyName}" 
                                  Width="*"/>
                <DataGridTextColumn Header="Contacto" 
                                  Binding="{Binding ContactName}" 
                                  Width="*"/>
                <DataGridTextColumn Header="Teléfono" 
                                  Binding="{Binding Phone}" 
                                  Width="Auto"/>
                <DataGridTextColumn Header="Email" 
                                  Binding="{Binding Email}" 
                                  Width="*"/>
                <DataGridTemplateColumn Header="Estado" Width="Auto">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <!-- Mostrar solo el texto sin convertir -->
                            <TextBlock Text="{Binding IsActive}" FontWeight="Medium" Margin="8,0"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>


            </DataGrid.Columns>
        </DataGrid>

        <!-- Estado -->
        <TextBlock Grid.Row="3"
                   Text="{Binding StatusMessage}"
                   Margin="0,10,0,0"
                   Foreground="Gray"/>
    </Grid>
</Page>